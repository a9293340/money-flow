# æ”¶å…¥é æ¸¬åŠŸèƒ½ - é‡æ–°è¨­è¨ˆæ–¹æ¡ˆ

## ðŸ“‹ å°ˆæ¡ˆèƒŒæ™¯

åŽŸæœ‰çš„æœŸæœ›æ¸…å–®/æ”¶å…¥é æ¸¬ç®¡ç†åŠŸèƒ½éŽæ–¼è¤‡é›œï¼ŒåŒ…å«å¤ªå¤šä½¿ç”¨è€…ä¸éœ€è¦çš„é¸é …å’ŒæŠ€è¡“æ¦‚å¿µã€‚åŸºæ–¼ä½¿ç”¨è€…å›žé¥‹ï¼Œæˆ‘å€‘éœ€è¦é‡æ–°è¨­è¨ˆä¸€å€‹**ç°¡å–®ã€ç›´è§€ã€å¯¦ç”¨**çš„æ”¶å…¥é æ¸¬åŠŸèƒ½ã€‚

### åŽŸæœ‰åŠŸèƒ½å•é¡Œ
- âŒ æ¨¡æ¿åŠŸèƒ½å¢žåŠ ä¸å¿…è¦è¤‡é›œæ€§
- âŒ æ™ºèƒ½åŒ¹é…/æ‰‹å‹•åŒ¹é…é¸é …é€ æˆå›°æƒ‘
- âŒ æœŸé–“ç”Ÿæˆæ¦‚å¿µå°ä½¿ç”¨è€…ä¸å‹å–„
- âŒ éŽå¤šé…ç½®é¸é …é€ æˆæ±ºç­–ç–²å‹ž
- âŒ å·¥ä½œæµç¨‹ä¸ç›´è§€

---

## ðŸŽ¯ æ–°è¨­è¨ˆç›®æ¨™

### æ ¸å¿ƒè¨­è¨ˆåŽŸå‰‡
1. **ç°¡å–®å„ªå…ˆ**ï¼šæœ€å°‘çš„è¨­å®šï¼Œæœ€å¤§çš„æ•ˆæžœ
2. **è‡ªå‹•åŒ–å„ªå…ˆ**ï¼šè¨­å®šå®Œæˆå¾Œè‡ªå‹•é‹ä½œ
3. **ç›´è§€æ“ä½œ**ï¼šåŠŸèƒ½åç¨±å’Œæµç¨‹ç¬¦åˆä½¿ç”¨è€…å¿ƒç†æ¨¡åž‹
4. **å³æ™‚åé¦ˆ**ï¼šæ“ä½œçµæžœç«‹å³å¯è¦‹

### ä½¿ç”¨è€…æ—…ç¨‹
```
å‰µå»ºæ”¶å…¥é æ¸¬ â†’ ç³»çµ±è‡ªå‹•è¿½è¹¤ â†’ æŸ¥çœ‹åˆ†æžçµæžœ â†’ æ‰‹å‹•èª¿æ•´ï¼ˆå¦‚éœ€è¦ï¼‰
```

---

## ðŸ”§ åŠŸèƒ½è¦æ ¼

### 1. å‰µå»ºæ”¶å…¥é æ¸¬ï¼ˆç°¡åŒ–ç‰ˆï¼‰

#### å¿…å¡«æ¬„ä½
- **æ”¶å…¥åç¨±**ï¼šä¾‹å¦‚ã€Œè–ªè³‡ã€ã€ã€Œæ¥­ç¸¾çŽé‡‘ã€
- **é æœŸé‡‘é¡**ï¼šä¾‹å¦‚ 50,000 å…ƒ
- **æ”¶å…¥åˆ†é¡ž**ï¼šå¾žç¾æœ‰æ”¶å…¥åˆ†é¡žä¸­é¸æ“‡
- **æ”¶å…¥é »çŽ‡**ï¼šæ¯é€±/æ¯æœˆ/æ¯å­£/æ¯å¹´
- **é–‹å§‹æ—¥æœŸ**ï¼šå¾žä½•æ™‚é–‹å§‹è¿½è¹¤

#### å¯é¸æ¬„ä½
- **çµæŸæ—¥æœŸ**ï¼šä¸å¡«è¡¨ç¤ºæŒçºŒè¿½è¹¤
- **å‚™è¨»**ï¼šæè¿°é€™å€‹æ”¶å…¥é …ç›®

#### æ™ºèƒ½åŒ¹é…è¨­å®šï¼ˆçµ±ä¸€è¨­å®šï¼‰
- **é‡‘é¡å®¹å·®**ï¼šé è¨­ 10%ï¼ˆå¯èª¿æ•´ 0-50%ï¼‰
- **æ—¥æœŸå®¹å·®**ï¼šé è¨­ 3 å¤©ï¼ˆå¯èª¿æ•´ 0-30 å¤©ï¼‰
- **è‡ªå‹•åŒ¹é…**ï¼šé è¨­é–‹å•Ÿï¼ˆå¯é—œé–‰ï¼‰

### 2. è‡ªå‹•è¿½è¹¤æ©Ÿåˆ¶

#### ç³»çµ±è‡ªå‹•åŸ·è¡Œ
1. **å»ºç«‹è¿½è¹¤æœŸé–“**ï¼šæ ¹æ“šé »çŽ‡è‡ªå‹•ç”¢ç”Ÿæ™‚é–“å€æ®µ
2. **æ™ºèƒ½åŒ¹é…æ”¶å…¥è¨˜éŒ„**ï¼šè‡ªå‹•å°‹æ‰¾ç¬¦åˆæ¢ä»¶çš„è¨˜éŒ„
3. **è¨ˆç®—çµ±è¨ˆæ•¸æ“š**ï¼šé”æˆçŽ‡ã€è¶¨å‹¢ã€å¥åº·åº¦ç­‰
4. **ç•°å¸¸æé†’**ï¼šé€¾æœŸã€ç•°å¸¸é‡‘é¡ç­‰

#### åŒ¹é…é‚è¼¯
```javascript
åŒ¹é…æ¢ä»¶ = {
  åˆ†é¡ž: ç›¸åŒæ”¶å…¥åˆ†é¡ž,
  é‡‘é¡: é æœŸé‡‘é¡ Â± å®¹å·®ç™¾åˆ†æ¯”,
  æ—¥æœŸ: æœŸé–“æ—¥æœŸ Â± å®¹å·®å¤©æ•¸
}
```

### 3. æª¢è¦–èˆ‡åˆ†æžé é¢

#### ä¸»è¦æª¢è¦–å€å¡Š
1. **æ¦‚è¦½å„€è¡¨æ¿**
   - æœ¬æœˆé æœŸæ”¶å…¥ vs å¯¦éš›æ”¶å…¥
   - æ•´é«”é”æˆçŽ‡
   - è¿‘æœŸç•°å¸¸é …ç›®

2. **æ”¶å…¥é …ç›®åˆ—è¡¨**
   - é¡¯ç¤ºæ‰€æœ‰æ”¶å…¥é æ¸¬é …ç›®
   - ç‹€æ…‹ï¼šæ­£å¸¸/å»¶é²/ç•°å¸¸
   - å¿«é€Ÿæ“ä½œæŒ‰éˆ•

3. **è©³ç´°åˆ†æž**ï¼ˆé»žæ“Šé …ç›®é€²å…¥ï¼‰
   - æ­·å²è¶¨å‹¢åœ–è¡¨
   - æŒ‰æœŸé–“çš„é”æˆæƒ…æ³
   - å¥åº·åº¦è©•åˆ†

#### æ ¸å¿ƒæ“ä½œåŠŸèƒ½
1. **æ‰‹å‹•æ­¸æª”**ï¼šå°‡ç‰¹å®šè¨˜éŒ„æ‰‹å‹•é—œè¯åˆ°æœŸé–“
2. **æ™ºèƒ½åŒ¹é…æ›´æ–°**ï¼šé‡æ–°åŸ·è¡Œè‡ªå‹•åŒ¹é…
3. **æª¢è¦–åˆ†æž**ï¼šæŸ¥çœ‹çµ±è¨ˆå’Œè¶¨å‹¢

---

## ðŸ—‚ï¸ è³‡æ–™åº«è¨­è¨ˆ

### IncomeForecasting ä¸»è¡¨
```javascript
{
  _id: ObjectId,
  userId: ObjectId,
  name: String,                    // æ”¶å…¥åç¨±
  expectedAmount: Number,          // é æœŸé‡‘é¡
  currency: String,                // å¹£åˆ¥ï¼Œé è¨­ 'TWD'
  incomeCategory: ObjectId,        // æ”¶å…¥åˆ†é¡ž ID
  frequency: String,               // 'weekly', 'monthly', 'quarterly', 'yearly'
  startDate: Date,                 // é–‹å§‹æ—¥æœŸ
  endDate: Date,                   // çµæŸæ—¥æœŸï¼ˆå¯é¸ï¼‰
  description: String,             // å‚™è¨»
  
  // æ™ºèƒ½åŒ¹é…è¨­å®š
  matchingConfig: {
    amountTolerance: Number,       // é‡‘é¡å®¹å·®ç™¾åˆ†æ¯”ï¼Œé è¨­ 10
    dateTolerance: Number,         // æ—¥æœŸå®¹å·®å¤©æ•¸ï¼Œé è¨­ 3
    autoMatch: Boolean             // æ˜¯å¦è‡ªå‹•åŒ¹é…ï¼Œé è¨­ true
  },
  
  // çµ±è¨ˆè³‡æ–™
  statistics: {
    totalPeriods: Number,          // ç¸½æœŸé–“æ•¸
    matchedPeriods: Number,        // å·²åŒ¹é…æœŸé–“æ•¸
    totalExpected: Number,         // ç¸½é æœŸé‡‘é¡
    totalReceived: Number,         // ç¸½å¯¦æ”¶é‡‘é¡
    achievementRate: Number,       // é”æˆçŽ‡
    lastMatchedAt: Date           // æœ€å¾ŒåŒ¹é…æ™‚é–“
  },
  
  isActive: Boolean,               // æ˜¯å¦å•Ÿç”¨
  isDeleted: Boolean,              // è»Ÿåˆªé™¤æ¨™è¨˜
  createdAt: Date,
  updatedAt: Date
}
```

### IncomePeriod æœŸé–“è¡¨
```javascript
{
  _id: ObjectId,
  forecastingId: ObjectId,         // é—œè¯çš„æ”¶å…¥é æ¸¬ ID
  userId: ObjectId,
  periodNumber: Number,            // æœŸé–“åºè™Ÿï¼ˆç¬¬1æœŸã€ç¬¬2æœŸ...ï¼‰
  startDate: Date,                 // æœŸé–“é–‹å§‹æ—¥æœŸ
  endDate: Date,                   // æœŸé–“çµæŸæ—¥æœŸ
  expectedAmount: Number,          // è©²æœŸé–“é æœŸé‡‘é¡
  
  // åŒ¹é…è³‡æ–™
  matchedRecords: [{
    recordId: ObjectId,            // åŒ¹é…çš„è¨˜éŒ„ ID
    matchedAmount: Number,         // åŒ¹é…é‡‘é¡
    confidence: Number,            // åŒ¹é…ä¿¡å¿ƒåº¦ (0-1)
    matchedAt: Date,              // åŒ¹é…æ™‚é–“
    isManual: Boolean             // æ˜¯å¦æ‰‹å‹•åŒ¹é…
  }],
  
  // çµ±è¨ˆè¨ˆç®—
  actualAmount: Number,            // å¯¦éš›æ”¶åˆ°é‡‘é¡
  status: String,                  // 'pending', 'partial', 'completed', 'overdue'
  achievementRate: Number,         // è©²æœŸé–“é”æˆçŽ‡
  healthScore: Number,             // å¥åº·åº¦è©•åˆ† (0-100)
  
  isDeleted: Boolean,
  createdAt: Date,
  updatedAt: Date
}
```

---

## ðŸ–¥ï¸ å‰ç«¯ä»‹é¢è¨­è¨ˆ

### é é¢çµæ§‹
```
/income-forecasting
â”œâ”€â”€ /                            # ä¸»é é¢ï¼ˆæ¦‚è¦½ + åˆ—è¡¨ï¼‰
â”œâ”€â”€ /new                         # æ–°å¢žæ”¶å…¥é æ¸¬
â”œâ”€â”€ /[id]                        # å–®ä¸€æ”¶å…¥é æ¸¬è©³ç´°é é¢
â””â”€â”€ /[id]/periods               # æœŸé–“ç®¡ç†é é¢
```

### ä¸»é é¢ä½ˆå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¨™é¡Œåˆ— + æ–°å¢žæŒ‰éˆ•                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ¦‚è¦½å¡ç‰‡å€                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚ â”‚æœ¬æœˆé æœŸâ”‚ â”‚å¯¦éš›æ”¶å…¥â”‚ â”‚é”æˆçŽ‡  â”‚        â”‚
â”‚ â”‚ 85,000 â”‚ â”‚ 82,500 â”‚ â”‚ 97.1%  â”‚        â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ”¶å…¥é æ¸¬é …ç›®åˆ—è¡¨                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ðŸ’° è–ªè³‡    â”‚ 50,000 â”‚ æ¯æœˆ â”‚ âœ… æ­£å¸¸â”‚ â”‚
â”‚ â”‚ ðŸ“ˆ æ¥­ç¸¾çŽé‡‘â”‚ 15,000 â”‚ æ¯å­£ â”‚ âš ï¸ å»¶é²â”‚ â”‚
â”‚ â”‚ ðŸŽ å¹´çµ‚çŽé‡‘â”‚ 100,000â”‚ æ¯å¹´ â”‚ â³ ç­‰å¾…â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è©³ç´°é é¢åŠŸèƒ½å€å¡Š
1. **åŸºæœ¬è³‡è¨Šå±•ç¤º**
2. **ä¸‰å€‹ä¸»è¦æ“ä½œæŒ‰éˆ•**
   - ðŸ”— æ‰‹å‹•æ­¸æª”
   - ðŸ¤– æ™ºèƒ½åŒ¹é…æ›´æ–°  
   - ðŸ“Š æª¢è¦–åˆ†æž
3. **æœŸé–“åˆ—è¡¨**ï¼ˆå¯æ‘ºç–Šï¼‰
4. **è¶¨å‹¢åœ–è¡¨**

---

## ðŸ”„ å·¥ä½œæµç¨‹

### å‰µå»ºæµç¨‹
1. ä½¿ç”¨è€…å¡«å¯«åŸºæœ¬è³‡è¨Š
2. ç³»çµ±é©—è­‰ä¸¦å„²å­˜
3. è‡ªå‹•ç”¢ç”Ÿç¬¬ä¸€å€‹æœŸé–“
4. é–‹å§‹èƒŒæ™¯æ™ºèƒ½åŒ¹é…

### æ—¥å¸¸é‹ä½œ
1. **è‡ªå‹•åŒ¹é…**ï¼ˆæ¯æ—¥åŸ·è¡Œï¼‰
   - æŽƒææ–°çš„æ”¶å…¥è¨˜éŒ„
   - æ ¹æ“šåŒ¹é…è¦å‰‡è‡ªå‹•é—œè¯
   - æ›´æ–°çµ±è¨ˆè³‡æ–™

2. **ä½¿ç”¨è€…ä»‹å…¥**ï¼ˆæŒ‰éœ€æ±‚ï¼‰
   - æª¢è¦–ç•°å¸¸é …ç›®
   - æ‰‹å‹•èª¿æ•´åŒ¹é…
   - æ›´æ–°é æ¸¬åƒæ•¸

### åˆ†æžæª¢è¦–
1. **å³æ™‚çµ±è¨ˆ**ï¼šé”æˆçŽ‡ã€è¶¨å‹¢ã€å¥åº·åº¦
2. **æ­·å²åˆ†æž**ï¼šéŽåŽ»6å€‹æœˆ/1å¹´çš„è¡¨ç¾
3. **é æ¸¬å»ºè­°**ï¼šåŸºæ–¼æ­·å²æ•¸æ“šçš„å»ºè­°

---

## ðŸš€ å¯¦ä½œè¨ˆåŠƒ

### Phase 1: æ ¸å¿ƒåŠŸèƒ½ (é€±æœŸ 1-2)
- [ ] å»ºç«‹æ–°çš„è³‡æ–™æ¨¡åž‹
- [ ] å‰µå»ºåŸºæœ¬ CRUD API
- [ ] å¯¦ä½œæ™ºèƒ½åŒ¹é…é‚è¼¯
- [ ] å»ºç«‹ä¸»é é¢å’Œæ–°å¢žé é¢

### Phase 2: é€²éšŽåŠŸèƒ½ (é€±æœŸ 3)
- [ ] è©³ç´°é é¢å’Œåˆ†æžåŠŸèƒ½
- [ ] æ‰‹å‹•æ­¸æª”æ“ä½œ
- [ ] æœŸé–“ç®¡ç†åŠŸèƒ½
- [ ] çµ±è¨ˆåœ–è¡¨

### Phase 3: å„ªåŒ–èˆ‡æ¸¬è©¦ (é€±æœŸ 4)
- [ ] æ•ˆèƒ½å„ªåŒ–
- [ ] ä½¿ç”¨è€…é«”é©—å„ªåŒ–
- [ ] æ¸¬è©¦èˆ‡é™¤éŒ¯
- [ ] æ–‡æª”å®Œå–„

---

## ðŸ’¡ é—œéµæ”¹é€²

### ç›¸è¼ƒæ–¼èˆŠç‰ˆæœ¬
1. **ç§»é™¤æ¨¡æ¿åŠŸèƒ½**ï¼šç›´æŽ¥å‰µå»ºå¯¦éš›é …ç›®
2. **çµ±ä¸€æ™ºèƒ½åŒ¹é…**ï¼šæ‰€æœ‰é …ç›®éƒ½ä½¿ç”¨æ™ºèƒ½åŒ¹é…ï¼Œå¯èª¿æ•´åƒæ•¸
3. **ç°¡åŒ–é…ç½®**ï¼šåªä¿ç•™å¿…è¦è¨­å®š
4. **ç›´è§€å‘½å**ï¼šä½¿ç”¨ä½¿ç”¨è€…ç†è§£çš„è©žå½™
5. **è‡ªå‹•åŒ–å„ªå…ˆ**ï¼šæœ€å°åŒ–æ‰‹å‹•æ“ä½œéœ€æ±‚

### ä½¿ç”¨è€…é«”é©—æå‡
- è¨­å®šæ­¥é©Ÿå¾ž 8 æ­¥ç°¡åŒ–ç‚º 4 æ­¥
- æŠ€è¡“æ¦‚å¿µç”¨è©žæ”¹ç‚ºæ—¥å¸¸ç”¨èªž
- ä¸€éµæ“ä½œå–ä»£å¤šæ­¥é©Ÿé…ç½®
- å³æ™‚åé¥‹å–ä»£å»¶é²æ›´æ–°

---

## ðŸ“Š æˆåŠŸæŒ‡æ¨™

### ä½¿ç”¨çŽ‡æŒ‡æ¨™
- æ–°å¢žæ”¶å…¥é æ¸¬çš„å®ŒæˆçŽ‡ > 80%
- ç”¨æˆ¶æ´»èºä½¿ç”¨å¤©æ•¸ > 30å¤©
- åŠŸèƒ½ä½¿ç”¨é »çŽ‡æå‡ 3x

### æ»¿æ„åº¦æŒ‡æ¨™
- ä½¿ç”¨è€…å›žé¥‹è©•åˆ† > 4/5
- æ”¯æ´ç¥¨æ•¸é‡æ¸›å°‘ 50%
- åŠŸèƒ½æ˜“ç”¨æ€§è©•åˆ† > 80%

---

**å»ºç«‹æ—¥æœŸ**: 2025-08-22  
**ç‰ˆæœ¬**: 1.0.0  
**ç‹€æ…‹**: å¾…å¯©æ ¸
